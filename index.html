<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Confirmaci√≥n de Invitados</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      text-align: center;
    }
    input, button {
      margin: 8px;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    .btnOpcion {
      background-color: #4a90e2;
      color: white;
      border: none;
      padding: 10px 20px;
      margin: 5px;
      border-radius: 6px;
      cursor: pointer;
    }
    .btnOpcion:hover {
      background-color: #357ABD;
    }
    #mensaje {
      margin-top: 15px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Confirmaci√≥n de Invitados</h1>
  <input type="text" id="nombre" placeholder="Ingrese su nombre">
  <button onclick="verificarInvitado()">Verificar</button>

  <div id="mensaje"></div>

  <div id="opciones" style="display: none;">
    <button class="btnOpcion" onclick="confirmarAsistencia(true)">‚úÖ Voy</button>
    <button class="btnOpcion" onclick="confirmarAsistencia(false)">‚ùå No voy</button>
  </div>

  <script>
    // Lista de invitados con su acompa√±ante
    const invitados = {
      "fulanito funcos": "Jimena C√≥rdoba",
      "alexis villalba": "Luc√≠a Torres Y Carla fachi",
      "juan g√≥mez": "Sof√≠a D√≠az"
    };

    function normalizar(texto) {
      return texto.toLowerCase()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "");
    }

    let invitadoEncontrado = null;

    function verificarInvitado() {
      const nombre = document.getElementById("nombre").value.trim();
      const msg = document.getElementById("mensaje");
      const opciones = document.getElementById("opciones");

      if (!nombre) {
        msg.textContent = "Por favor, ingrese su nombre.";
        msg.style.color = "red";
        opciones.style.display = "none";
        return;
      }

      const key = normalizar(nombre);
      const acomp = invitados[key];

      if (acomp) {
        msg.textContent = `${nombre.toUpperCase()} lleva a ${acomp}.`;
        msg.style.color = "green";
        opciones.style.display = "block";
        invitadoEncontrado = { nombre, acompanante: acomp };
      } else {
        msg.textContent = "Lo siento, no est√°s en la lista.";
        msg.style.color = "red";
        opciones.style.display = "none";
        invitadoEncontrado = null;
      }
    }

    function confirmarAsistencia(viene) {
      if (!invitadoEncontrado) return;

      // üü¢ Mostrar mensaje de confirmaci√≥n antes de enviar
      const textoConfirmacion = `${invitadoEncontrado.nombre} va con ${invitadoEncontrado.acompanante}.`;
      const confirmar = confirm(`${textoConfirmacion}\n\n¬øDesea confirmar que ${viene ? "ASISTIR√Å" : "NO ASISTIR√Å"}?`);

      if (!confirmar) {
        alert("No se envi√≥ ninguna respuesta.");
        return;
      }

      // URL de Google Form
      const formURL = "https://docs.google.com/forms/d/e/1FAIpQLScMvzxj6LL3F-FxWJvlcaBfbgnB-vKVw6zReEeaAOYwtlGJmg/formResponse";

      // Campos del formulario (IDs correctos)
      const data = new FormData();
      data.append("entry.2062533621", invitadoEncontrado.nombre);         // Nombre del invitado
      data.append("entry.490039814", invitadoEncontrado.acompanante);   // Acompa√±ante
      data.append("entry.2005093304", viene ? "Si voy" : "No voy"); // Confirmaci√≥n

      fetch(formURL, {
        method: "POST",
        mode: "no-cors",
        body: data
      })
      .then(() => {
        alert(`Respuesta registrada: ${viene ? "‚úÖ Asistir√°" : "‚ùå No asistir√°"}. ¬°Gracias!`);
        document.getElementById("opciones").style.display = "none";
      })
      .catch(error => {
        console.error("Error al enviar:", error);
        alert("Hubo un error al confirmar.");
      });
    }
  </script>
</body>
</html>